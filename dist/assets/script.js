window.onload=function(){setTimeout((function(){document.getElementById("loadingScreen").style.display="none",document.getElementById("mainContent").style.display="block"}),1500),setFixedCanvasSize()};var MAX_CANVAS_WIDTH=1200,MAX_CANVAS_HEIGHT=2800,painting=!1,currentColor="black",isEraserActive=!1,canvas=document.getElementById("drawingCanvas"),ctx=canvas.getContext("2d"),canvasWidth=1200,canvasHeight=2800;function setFixedCanvasSize(){canvas.width=MAX_CANVAS_WIDTH,canvas.height=MAX_CANVAS_HEIGHT}function applyDrawingEvents(){var e=document.getElementById("drawingCanvas"),t=e.getContext("2d"),n=!1,a="black",o=!1;e.addEventListener("mousedown",(function(i){n=!0,function(i){if(n){var c=e.getBoundingClientRect(),l=e.width/c.width,s=e.height/c.height,d=(i.clientX-c.left)*l,r=(i.clientY-c.top)*s;t.lineWidth=o?10:2,t.lineCap="round",t.strokeStyle=o?"white":a,t.lineTo(d,r),t.stroke(),t.beginPath(),t.moveTo(d,r)}}(i)})),e.addEventListener("mouseup",(function(){n=!1,t.beginPath()})),e.addEventListener("mousemove",(function(i){if(n){var c=e.getBoundingClientRect();console.log("Canvas Rect:",c),console.log("Mouse: X=".concat(i.clientX,", Y=").concat(i.clientY));var l=e.width/c.width,s=e.height/c.height;console.log("ScaleX: ".concat(l,", ScaleY: ").concat(s));var d=(i.clientX-c.left)*l,r=(i.clientY-c.top)*s;t.lineWidth=o?10:2,t.lineCap="round",t.strokeStyle=o?"white":a,t.lineTo(d,r),t.stroke(),t.beginPath(),t.moveTo(d,r)}})),document.getElementById("black").addEventListener("click",(function(){o=!1,a="black"})),document.getElementById("red").addEventListener("click",(function(){a="red"})),document.getElementById("blue").addEventListener("click",(function(){a="blue"})),document.getElementById("yellow").addEventListener("click",(function(){a="yellow"})),document.getElementById("eraser").addEventListener("click",(function(){o=!0,a="white"}))}canvas.width=canvasWidth,canvas.height=canvasHeight,document.getElementById("applyCanvasSize").addEventListener("click",(function(){var e=parseInt(document.getElementById("canvasWidth").value),t=parseInt(document.getElementById("canvasHeight").value);if(e>=100&&e<=MAX_CANVAS_WIDTH&&t>=100&&t<=MAX_CANVAS_HEIGHT){var n=ctx.getImageData(0,0,canvas.width,canvas.height),a=e/canvas.width,o=t/canvas.height;canvas.width=e,canvas.height=t,ctx.save(),ctx.scale(a,o),ctx.putImageData(n,0,0),ctx.restore(),alert("Canvas size changed to ".concat(e,"x").concat(t)),document.getElementById("canvasSizeMenu").style.display="none"}else alert("Please enter a valid size within the range: 100 - ".concat(MAX_CANVAS_WIDTH," for width, 100 - ").concat(MAX_CANVAS_HEIGHT," for height."))})),document.getElementById("openCanvasSizeMenu").addEventListener("click",(function(){var e=document.getElementById("canvasSizeMenu");e.style.display="none"===e.style.display||""===e.style.display?"block":"none"})),document.getElementById("closeCanvasSizeMenu").addEventListener("click",(function(){document.getElementById("canvasSizeMenu").style.display="none"})),applyDrawingEvents(),document.getElementById("save").addEventListener("click",(function(){var e=canvas.toDataURL("image/png"),t=document.createElement("a");t.href=e,t.download="drawing.png",t.click()})),document.getElementById("export").addEventListener("click",(function(){var e=fileTypeSelect.value;exportFile(e)}));var toolsContainer=document.getElementById("toolbox"),toolsContainerParent=toolsContainer.parentElement,isDraggingTools=!1;toolsContainer.addEventListener("mousedown",(function(e){isDraggingTools=!0,e.preventDefault()})),window.addEventListener("mousemove",(function(e){if(isDraggingTools){var t=toolsContainerParent.getBoundingClientRect(),n=e.pageX-t.left-toolsContainer.offsetWidth/2,a=e.pageY-t.top-toolsContainer.offsetHeight/2,o=t.width-toolsContainer.offsetWidth,i=t.height-toolsContainer.offsetHeight;toolsContainer.style.left="".concat(Math.max(0,Math.min(n,o)),"px"),toolsContainer.style.top="".concat(Math.max(0,Math.min(a,i)),"px")}})),window.addEventListener("mouseup",(function(){isDraggingTools=!1,toolsContainerParent.getBoundingClientRect();var e=window.innerWidth,t=window.innerHeight,n=Math.max(0,Math.min(toolsContainer.offsetLeft,e-toolsContainer.offsetWidth)),a=Math.max(0,Math.min(toolsContainer.offsetTop,t-toolsContainer.offsetHeight));toolsContainer.style.left="".concat(n,"px"),toolsContainer.style.top="".concat(a,"px")}));